<!-- expense-list.component.html (محدّث) -->
<div class="p-4">

    <p-toolbar class="mb-4">
        <div class="p-toolbar-group-left flex gap-2 items-center">
            <button pButton label="Add" icon="pi pi-plus" (click)="openAdd()"></button>

<p-dropdown [options]="categories" optionLabel="label" optionValue="value" placeholder="All Categories"
                [(ngModel)]="filterCategory" (onChange)="onFilterChange()"></p-dropdown>
   <input type="date" [(ngModel)]="filterFrom" (change)="onFilterChange()" class="p-inputtext" />
  <input type="date" [(ngModel)]="filterTo" (change)="onFilterChange()" class="p-inputtext" />

            <button pButton label="Clear" icon="pi pi-filter-slash" class="p-button-outlined"
                (click)="clearFilters()"></button>
        </div>

        <div class="p-toolbar-group-right flex items-center gap-2">
            <label>Rows</label>
            <p-dropdown
                [options]="[{label:'5',value:5},{label:'10',value:10},{label:'25',value:25},{label:'50',value:50}]"
                [(ngModel)]="rowsPerPage" (onChange)="onRowsPerPageChange()"></p-dropdown>
        </div>
    </p-toolbar>
   <p-table [value]="pagedExpenses" responsiveLayout="scroll">
        <ng-template pTemplate="header">
            <tr>
                <th (click)="toggleSort('title')">Title</th>
                <th>Category</th>
                <th (click)="toggleSort('amount')">Amount</th>
                <th (click)="toggleSort('date')">Date</th>
                <th>Note</th>
                <th>Actions</th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-exp>
            <tr>
                <td>{{exp.title}}</td>
                <td>{{getCategoryName(exp.category)}}</td>
                <td>{{exp.amount | number:'1.2-2'}}</td>
                <td>{{exp.date}}</td>
                <td>{{exp.note || '-'}}</td>
                <td>
                    <button pButton icon="pi pi-pencil" class="p-button-text" (click)="openEdit(exp)"></button>
                    <button pButton icon="pi pi-trash" class="p-button-text p-button-danger"
                        (click)="deleteExpense(exp.id)"></button>
                </td>
            </tr>
        </ng-template>

        <ng-template pTemplate="footer">
            <tr>
                <td colspan="6">
                    <div class="flex justify-between items-center">
                        <div>Showing {{filteredTotal}} items</div>
                        <div class="flex items-center gap-2">
                            <button pButton icon="pi pi-angle-left" (click)="prevPage()"
                                [disabled]="page === 0"></button>
                            <span>Page {{page+1}} / {{totalPages}}</span>
                            <button pButton icon="pi pi-angle-right" (click)="nextPage()"
                                [disabled]="page >= totalPages-1"></button>
                        </div>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>

</div>


